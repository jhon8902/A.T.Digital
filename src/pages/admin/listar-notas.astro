---
// src/pages/admin/listar-notas.astro
---

<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Listado de notas</title>
  </head>
  <body>
    <h1>Notas guardadas en la base de datos</h1>

    <table border="1" cellpadding="8">
      <thead>
        <tr>
          <th>ID</th>
          <th>T√≠tulo</th>
          <th>Categor√≠a</th>
          <th>Estado</th>
          <th>Fecha publicaci√≥n</th>
        </tr>
      </thead>
      <tbody id="tabla-notas">
        <!-- Aqu√≠ se insertar√°n las notas -->
      </tbody>
    </table>

    <script>
      async function cargarNotas() {
        const response = await fetch("/api/listar-notas");
        const notas = await response.json();

        const tbody = document.getElementById("tabla-notas");
        if (!tbody) return; // üö® Si no existe, se corta aqu√≠

        tbody.innerHTML = "";
        notas.forEach((nota) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
    <td>${nota.id}</td>
    <td>${nota.titulo}</td>
    <td>${nota.categoria_nombre}</td>
    <td>${nota.status}</td>
    <td>${new Date(nota.fecha_publicacion).toLocaleString()}</td>
  `;
          tbody.appendChild(tr);
        });
      }

      cargarNotas();
    </script>
  </body>
</html>
